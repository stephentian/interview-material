# 网络安全

- [XSS 跨站脚本攻击](#xss-跨站脚本攻击)
  - [XSS 攻击方式](#xss-攻击方式)
    - [反射型](#反射型)
    - [存储型](#存储型)
  - [XSS 防范措施](#xss-防范措施)
- [CSRF 跨站请求伪造](#csrf-跨站请求伪造)
  - [CSRF 攻击原理](#csrf-攻击原理)
  - [CSRF 防御措施](#csrf-防御措施)
- [XSS 和 CSRF 区别](#xss-和-csrf-区别)

## XSS 跨站脚本攻击

> cross site script

攻击者通过注入恶意脚本到网站页面中，来获取用户的信息或者执行某些恶意操作。

### XSS 攻击方式

#### 反射型

通过构造特定的 URL，将恶意脚本作为参数传递给网站，当用户访问该URL时，网站会将恶意脚本回显到页面中，从而获取用户的敏感信息或者执行某些恶意操作。

#### 存储型

攻击者将恶意脚本存储在网站的数据库或者缓存中，当用户访问特定页面时，网站会从数据库或缓存中读取数据，并将恶意脚本注入到页面中。获取用户的敏感信息或者执行某些恶意操作。

比非持久性XSS攻击危害性更大。

比如：
网页有一个发表评论的功能，该评论会写入后台数据库，并且访问主页的时候，会从数据库中加载出所有的评论。
用户添加一个评论，并且暗藏一个脚本。
当别人访问主页的时候，刚刚黑客写入的评论里面的脚本被浏览器当成代码执行了，用户莫名其妙受到攻击。

### XSS 防范措施

1. 对输入的数据进行转义保存，过滤数据。
2. 尽量避免使用 `eval` 或者 `new Function` 等执行字符串方法。
3. 使用 `HTTP-Only cookie`，一种特殊的 cookie，它只能被服务器读取，不能被客户端脚本访问。

## CSRF 跨站请求伪造

> cross site request forgery

### CSRF 攻击原理

冒充用户发送一些违反用户意愿的请求。
比如用户原来访问过 A 网站，存了登录 A 网站的 Cookie,
然后用户访问 B 网站时，B 网站可能有过引诱链接，这个链接是访问 A 网站的，
可能用户点击了链接，但是用户不清楚自己进了 A 网站。（新浪微博莫名其妙增加关注）

### CSRF 防御措施

1. Token 验证
2. Referer 验证
  检查 HTTP 请求头 referer 是否为同源（Origin）
3. 隐藏令牌
  隐藏令牌，类似 token， 比如藏在 http header 中

## XSS 和 CSRF 区别

1. 攻击方式：XSS是一种注入攻击，注入脚本到用户页面；CSRF是一种伪造用户请求攻击。
2. 防御方式：防御 XSS 攻击的主要方式是过滤用户输入，防止恶意脚本的注入。而防御 CSRF 攻击的主要方式是添加验证码或者 token，以验证请求的真实性。
3. 攻击对象：XSS 攻击的对象是网站页面的用户，CSRF 攻击的对象是网站的后台管理员或者其他有权限的用户。
4. 攻击条件：XSS 可以不需要用户登录，CSRF 需要用户登录。
